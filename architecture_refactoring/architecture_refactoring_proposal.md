# GraylumAI ç°ä»£åŒ–æ¶æ„é‡æ„æ–¹æ¡ˆ

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0
**ç”Ÿæˆæ—¥æœŸ**: 2026-01-14
**ä½œè€…**: Manus AI

---

## 1. æ–¹æ¡ˆæ¦‚è¿°

åŸºäºå¯¹ GraylumAI é¡¹ç›®ç°æœ‰æ¶æ„çš„æ·±å…¥åˆ†æï¼Œæˆ‘ä»¬å‘ç°å…¶åœ¨æŠ€æœ¯æ ˆã€æ¶æ„æ¨¡å¼å’Œå¼€å‘å®è·µä¸Šå­˜åœ¨è¯¸å¤šå¯ä»¥ä¼˜åŒ–çš„ç©ºé—´ã€‚å½“å‰æ¶æ„é«˜åº¦ä¾èµ–å¹³å°å³æœåŠ¡ï¼ˆPaaSï¼‰çš„é»‘ç›’èƒ½åŠ›ï¼Œå¯¼è‡´å¯ç»´æŠ¤æ€§ã€å¯æ‰©å±•æ€§å’Œå¼€å‘ä½“éªŒå—é™ã€‚

æœ¬æ–¹æ¡ˆæ—¨åœ¨æå‡ºä¸€ä¸ª**é¢å‘æœªæ¥ã€é«˜å†…èšã€ä½è€¦åˆã€å…·å¤‡å“è¶Šå¼€å‘ä½“éªŒ**çš„ç°ä»£åŒ–æ¶æ„ã€‚æˆ‘ä»¬å°†é‡‡ç”¨ä¸šç•Œé¢†å…ˆçš„å¼€æºæŠ€æœ¯å’Œæœ€ä½³å®è·µï¼Œå°† GraylumAI é‡æ„ä¸ºä¸€ä¸ªå¥å£®ã€é«˜æ•ˆä¸”æ˜“äºç»´æŠ¤çš„å…¨æ ˆ TypeScript åº”ç”¨ã€‚

---

## 2. æ ¸å¿ƒè®¾è®¡åŸåˆ™

- **ç±»å‹å®‰å…¨è‡³ä¸Š (Type-Safety First)**: ä»å‰ç«¯åˆ°åç«¯å†åˆ°æ•°æ®åº“ï¼Œå®ç°ç«¯åˆ°ç«¯çš„ç±»å‹å®‰å…¨ï¼Œæœ€å¤§åŒ–åœ°å‡å°‘è¿è¡Œæ—¶é”™è¯¯ã€‚
- **å•ä¸€ä»£ç åº“ (Monorepo)**: é‡‡ç”¨ Monorepo ç®¡ç†æ¨¡å¼ï¼Œç®€åŒ–ä¾èµ–ç®¡ç†ï¼Œä¿ƒè¿›ä»£ç å…±äº«ï¼Œæå‡å¼€å‘æ•ˆç‡ã€‚
- **å…³æ³¨ç‚¹åˆ†ç¦» (Separation of Concerns)**: ä¸¥æ ¼åˆ’åˆ†å±•ç¤ºå±‚ã€ä¸šåŠ¡é€»è¾‘å±‚å’Œæ•°æ®è®¿é—®å±‚ï¼Œä½¿ä»£ç æ›´æ¸…æ™°ã€æ›´æ˜“äºæµ‹è¯•ã€‚
- **å¼€å‘è€…ä½“éªŒä¼˜å…ˆ (Developer Experience)**: å¼•å…¥è‡ªåŠ¨åŒ–å·¥å…·ã€æ ‡å‡†åŒ–æµç¨‹å’Œé«˜æ•ˆçš„å¼€å‘æ¨¡å¼ï¼Œè®©å¼€å‘è€…ä¸“æ³¨äºä¸šåŠ¡é€»è¾‘ã€‚
- **æ‹¥æŠ± Serverless**: å……åˆ†åˆ©ç”¨ Vercel å’Œ Supabase çš„ Serverless èƒ½åŠ›ï¼Œå®ç°å¼¹æ€§ä¼¸ç¼©å’ŒæŒ‰éœ€ä»˜è´¹ï¼Œé™ä½è¿ç»´æˆæœ¬ã€‚

---

## 3. æ¨èæŠ€æœ¯æ ˆä¸æ¶æ„

æˆ‘ä»¬å°†é‡‡ç”¨ä»¥ **Next.js** å’Œ **tRPC** ä¸ºæ ¸å¿ƒçš„å…¨æ ˆ TypeScript æ–¹æ¡ˆã€‚

| å±‚é¢ | æ¨èæŠ€æœ¯ | æ›¿ä»£æ–¹æ¡ˆ | ä¼˜åŠ¿è¯´æ˜ |
|---|---|---|---|
| **ä»£ç åº“ç®¡ç†** | **Turborepo** | Lerna, Nx | ä¸“ä¸º TypeScript/JavaScript é¡¹ç›®ä¼˜åŒ–ï¼Œé€Ÿåº¦å¿«ï¼Œé…ç½®ç®€å•ã€‚ |
| **å‰ç«¯æ¡†æ¶** | **Next.js (App Router)** | Vite + React | æä¾›å¼ºå¤§çš„è·¯ç”±ã€SSR/SSGã€API è·¯ç”±ç­‰åŠŸèƒ½ï¼Œæ˜¯æ„å»ºç°ä»£ Web åº”ç”¨çš„äº‹å®æ ‡å‡†ã€‚ |
| **UI ç»„ä»¶åº“** | **Shadcn/ui** | Material-UI, Ant Design | åŸºäº Radix UI å’Œ Tailwind CSSï¼Œç¾è§‚ã€å¯è®¿é—®æ€§å¥½ï¼Œéä¾µå…¥å¼ï¼Œå¯å®šåˆ¶æ€§æé«˜ã€‚ |
| **çŠ¶æ€ç®¡ç†** | **Zustand / Jotai** | Redux Toolkit | è½»é‡ã€ç®€æ´ï¼ŒAPI ç›´è§‚ï¼Œå®Œç¾é€‚é… React Hooksï¼Œé¿å…äº† Redux çš„æ¨¡æ¿ä»£ç ã€‚ |
| **æ•°æ®è¯·æ±‚** | **TanStack Query** | SWR, Apollo Client | è‡ªåŠ¨ç®¡ç†ç¼“å­˜ã€åå°åˆ·æ–°ã€è¯·æ±‚é‡è¯•ç­‰ï¼Œæå¤§ç®€åŒ–æœåŠ¡ç«¯çŠ¶æ€ç®¡ç†ã€‚ |
| **åç«¯ API** | **tRPC** | GraphQL, REST | æ— éœ€å®šä¹‰ Schemaï¼Œè‡ªåŠ¨å®ç°ç«¯åˆ°ç«¯çš„ç±»å‹å®‰å…¨ APIï¼Œæå¤§æå‡å¼€å‘æ•ˆç‡å’Œä»£ç å¥å£®æ€§ã€‚ |
| **æ•°æ®åº“ ORM** | **Drizzle ORM** | Prisma | è½»é‡ã€é«˜æ€§èƒ½ï¼Œæä¾› SQL-like çš„æŸ¥è¯¢è¯­æ³•å’Œå¼ºå¤§çš„ç±»å‹æ¨æ–­ï¼Œä¸ tRPC å®Œç¾ç»“åˆã€‚ |
| **æ•°æ®éªŒè¯** | **Zod** | Yup, Joi | API ç®€æ´ï¼Œä¸ TypeScript æ·±åº¦é›†æˆï¼Œå¯åŒæ—¶ç”¨äºè¿è¡Œæ—¶éªŒè¯å’Œç±»å‹ç”Ÿæˆã€‚ |
| **è®¤è¯** | **Supabase Auth** | NextAuth.js | ä¸ Supabase ç”Ÿæ€æ— ç¼é›†æˆï¼Œæä¾›å®Œæ•´çš„ç”¨æˆ·ç®¡ç†å’Œè¡Œçº§å®‰å…¨ï¼ˆRLSï¼‰èƒ½åŠ›ã€‚ |
| **CI/CD** | **GitHub Actions** | GitLab CI, Jenkins | ä¸ GitHub ä»“åº“åŸç”Ÿé›†æˆï¼Œç¤¾åŒºç”Ÿæ€ä¸°å¯Œï¼Œé…ç½®ç®€å•ã€‚ |
| **æµ‹è¯•** | **Vitest + React Testing Library** | Jest | å…¼å®¹ Jest APIï¼Œé€Ÿåº¦æ›´å¿«ï¼Œä¸ Vite/Next.js é›†æˆæ›´ä½³ã€‚ |

---

## 4. æ–°æ¶æ„è¯¦è§£

### 4.1. Monorepo ç›®å½•ç»“æ„

æˆ‘ä»¬å°†ä½¿ç”¨ Turborepo æ¥ç»„ç»‡é¡¹ç›®ï¼Œå®ç°å‰åç«¯ä»£ç ã€å…±äº«å·¥å…·åº“çš„ç»Ÿä¸€ç®¡ç†ã€‚

```
graylumAi-backup/
â”œâ”€â”€ apps/
â”‚   â””â”€â”€ web/                  # Next.js å‰ç«¯åº”ç”¨
â”‚       â”œâ”€â”€ src/
â”‚       â”‚   â”œâ”€â”€ app/          # Next.js App Router
â”‚       â”‚   â”œâ”€â”€ components/   # UI ç»„ä»¶
â”‚       â”‚   â”œâ”€â”€ lib/          # å·¥å…·å‡½æ•°
â”‚       â”‚   â””â”€â”€ trpc/         # tRPC å®¢æˆ·ç«¯
â”‚       â””â”€â”€ package.json
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ api/                  # tRPC åç«¯è·¯ç”±å’Œé€»è¾‘
â”‚   â”œâ”€â”€ db/                   # Drizzle ORM Schema å’Œè¿ç§»è„šæœ¬
â”‚   â”œâ”€â”€ ui/                   # å…±äº«çš„ React UI ç»„ä»¶ (ä½¿ç”¨ Shadcn/ui)
â”‚   â”œâ”€â”€ eslint-config-custom/ # å…±äº«çš„ ESLint é…ç½®
â”‚   â””â”€â”€ tsconfig/             # å…±äº«çš„ TypeScript é…ç½®
â”œâ”€â”€ package.json
â””â”€â”€ turborepo.json
```

### 4.2. æ•°æ®æµä¸ API è®¾è®¡

1.  **å‰ç«¯ç»„ä»¶**: React Server Component (RSC) æˆ– Client Component å‘èµ·æ•°æ®è¯·æ±‚ã€‚
2.  **tRPC å®¢æˆ·ç«¯**: å‰ç«¯é€šè¿‡ç±»å‹å®‰å…¨çš„ tRPC å®¢æˆ·ç«¯è°ƒç”¨åç«¯è¿‡ç¨‹ï¼Œå°±åƒè°ƒç”¨ä¸€ä¸ªæœ¬åœ°å‡½æ•°ä¸€æ ·ã€‚
3.  **Next.js API è·¯ç”±**: Next.js æ•è· `/api/trpc/*` çš„è¯·æ±‚ï¼Œå¹¶å°†å…¶è½¬å‘ç»™ tRPC è·¯ç”±å™¨ã€‚
4.  **tRPC åç«¯**: `packages/api` ä¸­å®šä¹‰çš„ tRPC è·¯ç”±å™¨æ¥æ”¶è¯·æ±‚ï¼Œå¹¶è°ƒç”¨ç›¸åº”çš„ä¸šåŠ¡é€»è¾‘ã€‚
5.  **æ•°æ®éªŒè¯**: Zod ç”¨äºéªŒè¯ API çš„è¾“å…¥å‚æ•°ã€‚
6.  **ä¸šåŠ¡é€»è¾‘**: ä¸šåŠ¡é€»è¾‘å±‚å¤„ç†å…·ä½“çš„ä¸šåŠ¡éœ€æ±‚ï¼Œå¦‚è°ƒç”¨å¤–éƒ¨ AI APIã€‚
7.  **Drizzle ORM**: ä¸šåŠ¡é€»è¾‘é€šè¿‡ Drizzle ORM ä¸ Supabase æ•°æ®åº“è¿›è¡Œäº¤äº’ã€‚
8.  **æ•°æ®åº“**: Supabase PostgreSQL å­˜å‚¨æ•°æ®ï¼Œå¹¶é€šè¿‡è¡Œçº§å®‰å…¨ï¼ˆRLSï¼‰ä¿è¯æ•°æ®éš”ç¦»ã€‚

è¿™ç§æ¶æ„å®ç°äº†**å®Œå…¨çš„ç«¯åˆ°ç«¯ç±»å‹å®‰å…¨**ã€‚å½“ä½ åœ¨ `packages/db` ä¸­ä¿®æ”¹ä¸€ä¸ªæ•°æ®åº“å­—æ®µæ—¶ï¼ŒTypeScript ä¼šç«‹åˆ»åœ¨ä½ çš„å‰ç«¯ç»„ä»¶ä¸­æç¤ºç±»å‹é”™è¯¯ï¼Œä»è€Œåœ¨ç¼–è¯‘é˜¶æ®µå°±å‘ç°é—®é¢˜ã€‚

### 4.3. çŠ¶æ€ç®¡ç†ç­–ç•¥

- **æœåŠ¡ç«¯çŠ¶æ€**: ä½¿ç”¨ **TanStack Query**ã€‚æ‰€æœ‰æ¥è‡ªåç«¯çš„æ•°æ®ï¼Œå¦‚ç”¨æˆ·ä¿¡æ¯ã€å¯¹è¯åˆ—è¡¨ç­‰ï¼Œéƒ½åº”é€šè¿‡ TanStack Query è¿›è¡Œç®¡ç†ã€‚å®ƒèƒ½è‡ªåŠ¨å¤„ç†ç¼“å­˜ã€åŒæ­¥å’Œæ›´æ–°ï¼Œæˆ‘ä»¬æ— éœ€æ‰‹åŠ¨ç®¡ç†è¿™äº›çŠ¶æ€ã€‚
- **å®¢æˆ·ç«¯çŠ¶æ€**: ä½¿ç”¨ **Zustand**ã€‚å¯¹äºçº¯å®¢æˆ·ç«¯çš„çŠ¶æ€ï¼Œå¦‚ UI ä¸»é¢˜ã€è¡¨å•è¾“å…¥ã€å¼¹çª—å¼€å…³ç­‰ï¼Œä½¿ç”¨ Zustand è¿›è¡Œç®¡ç†ã€‚å…¶ç®€æ´çš„ API å¯ä»¥è½»æ¾åˆ›å»ºå’Œä½¿ç”¨çŠ¶æ€å­˜å‚¨ã€‚

### 4.4. æ•°æ®åº“è®¾è®¡ä¸è¿ç§»

- **Schema å®šä¹‰**: åœ¨ `packages/db` ä¸­ä½¿ç”¨ Drizzle ORM å®šä¹‰æ‰€æœ‰è¡¨çš„ Schemaã€‚è¿™ä½¿å¾— Schema ä¸ä»£ç åŒæºï¼Œæ˜“äºç‰ˆæœ¬æ§åˆ¶ã€‚
- **è¿ç§»ç®¡ç†**: ä½¿ç”¨ `drizzle-kit` è‡ªåŠ¨ç”Ÿæˆ SQL è¿ç§»è„šæœ¬ã€‚æ¯æ¬¡ Schema å˜æ›´åï¼Œç”Ÿæˆä¸€ä¸ªæ–°çš„è¿ç§»æ–‡ä»¶ï¼Œç¡®ä¿æ•°æ®åº“ç»“æ„çš„ç‰ˆæœ¬åŒ–å’Œå¯è¿½æº¯æ€§ã€‚

---

## 5. ä¸ºä»€ä¹ˆè¿™ä¸ªæ¶æ„æ›´å¥½ï¼Ÿ

| å¯¹æ¯”ç»´åº¦ | åŸæ¶æ„ (Base44) | æ–°æ¶æ„ (Manus æ¨è) |
|---|---|---|
| **ç±»å‹å®‰å…¨** | âŒ æ—  (çº¯ JS) | âœ… **ç«¯åˆ°ç«¯ç±»å‹å®‰å…¨** (TypeScript + tRPC) |
| **ä»£ç ç»„ç»‡** | æ··åˆåœ¨å•ä½“åº”ç”¨ä¸­ | âœ… **æ¸…æ™°çš„ Monorepo** (Turborepo) |
| **API å¥å£®æ€§** | ä¾èµ–æ‰‹åŠ¨æµ‹è¯• | âœ… **ç¼–è¯‘æ—¶ä¿è¯ API å…¼å®¹æ€§** |
| **å¼€å‘æ•ˆç‡** | ä¾èµ–å¹³å°æ–‡æ¡£ | âœ… **è‡ªåŠ¨è¡¥å…¨å’Œç±»å‹æ¨æ–­æå¤§æå‡æ•ˆç‡** |
| **å¯ç»´æŠ¤æ€§** | é€»è¾‘è€¦åˆï¼Œéš¾ä»¥é‡æ„ | âœ… **åˆ†å±‚æ¸…æ™°ï¼Œæ˜“äºæµ‹è¯•å’Œæ‰©å±•** |
| **æŠ€æœ¯é”å®š** | ğŸ”’ æ·±åº¦ç»‘å®š Base44 | ğŸŒ **å®Œå…¨åŸºäºå¼€æºæŠ€æœ¯ï¼Œæ— å‚å•†é”å®š** |
| **ç¤¾åŒºç”Ÿæ€** | æœ‰é™ | ğŸŒŸ **æå…¶æ´»è·ƒå’Œåºå¤§çš„ç¤¾åŒºæ”¯æŒ** |

---

## 6. ç»“è®º

è™½ç„¶ä» Base44 è¿ç§»åˆ° Vercel + Supabase å·²ç»æ˜¯ä¸€ä¸ªå·¨å¤§çš„è¿›æ­¥ï¼Œä½†ä»…ä»…è¿›è¡Œâ€œå¹³ç§»â€å¼çš„è¿ç§»ï¼Œæ— æ³•å®Œå…¨å‘æŒ¥æ–°å¹³å°çš„æ½œåŠ›ã€‚é€šè¿‡æœ¬æ¬¡æ¶æ„é‡æ„ï¼Œæˆ‘ä»¬å¯ä»¥ä¸€åŠ³æ°¸é€¸åœ°è§£å†³ç°æœ‰ä»£ç åº“çš„æ·±å±‚æ¬¡é—®é¢˜ï¼Œä¸º GraylumAI æœªæ¥çš„å¿«é€Ÿå‘å±•å¥ å®šåšå®çš„æŠ€æœ¯åŸºç¡€ã€‚

è¿™ä¸ªæ–¹æ¡ˆä¸ä»…æ˜¯ä¸€ä¸ªæŠ€æœ¯å‡çº§ï¼Œæ›´æ˜¯ä¸€æ¬¡å¯¹**å¼€å‘æµç¨‹å’Œè´¨é‡æ ‡å‡†**çš„å…¨é¢é©æ–°ã€‚


---

## 7. å®æ–½è·¯çº¿å›¾

æˆ‘ä»¬å»ºè®®é‡‡ç”¨åˆ†é˜¶æ®µçš„æ–¹å¼è¿›è¡Œé‡æ„ï¼Œç¡®ä¿æ¯ä¸€æ­¥éƒ½æ˜¯å¯æ§å’Œå¯éªŒè¯çš„ã€‚

### **é˜¶æ®µ 1: ç¯å¢ƒæ­å»ºä¸åˆå§‹åŒ– (1-2å¤©)**

1.  **åˆå§‹åŒ– Monorepo**: ä½¿ç”¨ `pnpm` å’Œ `Turborepo` åˆ›å»ºé¡¹ç›®éª¨æ¶ã€‚
2.  **åˆ›å»ºåº”ç”¨å’ŒåŒ…**: åˆ›å»º `apps/web` (Next.js) å’Œ `packages/api`, `packages/db` ç­‰æ ¸å¿ƒåŒ…ã€‚
3.  **é…ç½®åŸºç¡€å·¥å…·**: é…ç½® TypeScript, ESLint, Prettier, Husky, Vitestã€‚
4.  **è¿æ¥ Supabase**: åˆ›å»º Supabase é¡¹ç›®ï¼Œå¹¶åœ¨ `apps/web` å’Œ `packages/db` ä¸­é…ç½®ç¯å¢ƒå˜é‡ã€‚

### **é˜¶æ®µ 2: æ•°æ®åº“ä¸è®¤è¯ (2-3å¤©)**

1.  **å®šä¹‰ Schema**: åœ¨ `packages/db` ä¸­ä½¿ç”¨ Drizzle ORM å®šä¹‰æ‰€æœ‰æ•°æ®åº“è¡¨çš„ Schemaã€‚
2.  **ç”Ÿæˆè¿ç§»è„šæœ¬**: ä½¿ç”¨ `drizzle-kit` ç”Ÿæˆåˆå§‹çš„æ•°æ®åº“è¿ç§»è„šæœ¬ã€‚
3.  **æ‰§è¡Œè¿ç§»**: åœ¨ Supabase æ•°æ®åº“ä¸­æ‰§è¡Œè¿ç§»ï¼Œåˆ›å»ºæ‰€æœ‰è¡¨ã€‚
4.  **é…ç½® Supabase Auth**: åœ¨å‰ç«¯å®ç°åŸºäº Supabase çš„ç™»å½•ã€æ³¨å†Œã€ç™»å‡ºæµç¨‹ã€‚
5.  **åˆ›å»ºç”¨æˆ· Profile**: å®ç°ç”¨æˆ·ç™»å½•åè‡ªåŠ¨åœ¨ `profiles` è¡¨ä¸­åˆ›å»ºè®°å½•çš„é€»è¾‘ã€‚

### **é˜¶æ®µ 3: åç«¯ API é‡æ„ (5-7å¤©)**

1.  **æ­å»º tRPC æœåŠ¡**: åœ¨ `packages/api` ä¸­åˆ›å»º tRPC è·¯ç”±å™¨å’Œä¸Šä¸‹æ–‡ã€‚
2.  **é‡æ„ä¸šåŠ¡é€»è¾‘**: å°†åŸæœ‰çš„ 21 ä¸ªäº‘å‡½æ•°é€»è¾‘ï¼Œé€ä¸€é‡æ„ä¸º tRPC çš„ `procedure`ã€‚
    - **åŸåˆ™**: æ¯ä¸ª `procedure` èŒè´£å•ä¸€ï¼Œéµå¾ª `è¾“å…¥éªŒè¯ -> ä¸šåŠ¡å¤„ç† -> æ•°æ®æ“ä½œ` çš„æ¨¡å¼ã€‚
    - **ä¼˜å…ˆè¿ç§»**: ä¼˜å…ˆè¿ç§»ä¸ç”¨æˆ·ã€ç§¯åˆ†ã€å·¥å•ç›¸å…³çš„æ ¸å¿ƒä¸šåŠ¡ã€‚
3.  **å®ç°æ ¸å¿ƒæœåŠ¡**: é‡ç‚¹é‡æ„ `smartChatWithSearch` é€»è¾‘ï¼Œå°†å…¶æ‹†åˆ†ä¸ºå¤šä¸ªå¯å¤ç”¨çš„æœåŠ¡å‡½æ•°ã€‚
4.  **é›†æˆå¤–éƒ¨ API**: å°è£…å¯¹ AI API å’Œæœç´¢ API çš„è°ƒç”¨ã€‚

### **é˜¶æ®µ 4: å‰ç«¯ UI ä¸é€»è¾‘é‡æ„ (7-10å¤©)**

1.  **å¼•å…¥ Shadcn/ui**: åˆå§‹åŒ– UI åº“ï¼Œå¹¶é€æ­¥æ›¿æ¢ç°æœ‰ç»„ä»¶ã€‚
2.  **é‡æ„é¡µé¢**: ä½¿ç”¨ Next.js App Router çš„æ¨¡å¼é‡æ„æ‰€æœ‰é¡µé¢ã€‚
    - **åˆ©ç”¨ Server Components**: å°½å¯èƒ½ä½¿ç”¨ Server Components æ¥è·å–æ•°æ®ï¼Œå‡å°‘å®¢æˆ·ç«¯è´Ÿæ‹…ã€‚
    - **çŠ¶æ€ç®¡ç†**: ä½¿ç”¨ TanStack Query ç®¡ç†æœåŠ¡ç«¯çŠ¶æ€ï¼ŒZustand ç®¡ç†å®¢æˆ·ç«¯ UI çŠ¶æ€ã€‚
3.  **æ›¿æ¢ API è°ƒç”¨**: å°†æ‰€æœ‰å¯¹ `base44Client` çš„è°ƒç”¨æ›¿æ¢ä¸ºå¯¹ tRPC å®¢æˆ·ç«¯çš„è°ƒç”¨ã€‚
4.  **ç»„ä»¶åŒ–**: å°†å¯å¤ç”¨çš„ UI å’Œé€»è¾‘æŠ½ç¦»åˆ° `packages/ui` å’Œ `apps/web/lib` ä¸­ã€‚

### **é˜¶æ®µ 5: æµ‹è¯•ã€éƒ¨ç½²ä¸ä¼˜åŒ– (3-5å¤©)**

1.  **ç¼–å†™æµ‹è¯•**: ä¸ºæ ¸å¿ƒä¸šåŠ¡é€»è¾‘å’Œç»„ä»¶ç¼–å†™å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•ã€‚
2.  **ç«¯åˆ°ç«¯æµ‹è¯•**: å¯¹æ•´ä¸ªåº”ç”¨è¿›è¡Œå®Œæ•´çš„åŠŸèƒ½å›å½’æµ‹è¯•ã€‚
3.  **é…ç½® CI/CD**: åœ¨ GitHub Actions ä¸­é…ç½®è‡ªåŠ¨åŒ–æµ‹è¯•å’Œéƒ¨ç½²åˆ° Vercel çš„æµç¨‹ã€‚
4.  **æ€§èƒ½ä¼˜åŒ–**: ä½¿ç”¨ Next.js çš„åˆ†æå·¥å…·å’Œ Vercel çš„ç›‘æ§æœåŠ¡ï¼Œè¯†åˆ«å¹¶ä¼˜åŒ–æ€§èƒ½ç“¶é¢ˆã€‚
5.  **æ•°æ®è¿ç§»**: ç¼–å†™æœ€ç»ˆçš„æ•°æ®è¿ç§»è„šæœ¬ï¼Œå°† Base44 çš„æ•°æ®å¯¼å…¥åˆ° Supabaseã€‚

---

## 8. å¼€å‘æœ€ä½³å®è·µ

ä¸ºäº†ä¿è¯é¡¹ç›®çš„é•¿æœŸå¥åº·å’Œé«˜è´¨é‡ï¼Œæˆ‘ä»¬å»ºè®®éµå¾ªä»¥ä¸‹æœ€ä½³å®è·µï¼š

### **ä»£ç è§„èŒƒ**
- **ESLint & Prettier**: å¼ºåˆ¶æ‰§è¡Œç»Ÿä¸€çš„ä»£ç é£æ ¼å’Œè´¨é‡æ ‡å‡†ã€‚
- **å‘½åçº¦å®š**: éµå¾ªæ¸…æ™°ã€ä¸€è‡´çš„å‘½åçº¦å®šï¼ˆä¾‹å¦‚ï¼Œç»„ä»¶ç”¨ PascalCaseï¼Œå‡½æ•°ç”¨ camelCaseï¼‰ã€‚
- **æ³¨é‡Š**: å¯¹å¤æ‚çš„ä¸šåŠ¡é€»è¾‘å’Œéç›´è§‚çš„ä»£ç è¿›è¡Œæ¸…æ™°çš„æ³¨é‡Šã€‚

### **Git å·¥ä½œæµ**
- **Git Flow**: é‡‡ç”¨ `main` (ç”Ÿäº§), `develop` (å¼€å‘), `feature/xxx` (åŠŸèƒ½) çš„åˆ†æ”¯æ¨¡å‹ã€‚
- **Pull Request**: æ‰€æœ‰ä»£ç åˆå¹¶å¿…é¡»é€šè¿‡ Pull Requestï¼Œå¹¶è¿›è¡Œä»£ç å®¡æŸ¥ï¼ˆCode Reviewï¼‰ã€‚
- **Conventional Commits**: æäº¤ä¿¡æ¯éµå¾ªçº¦å®šå¼æäº¤è§„èŒƒï¼ˆå¦‚ `feat:`, `fix:`, `docs:`ï¼‰ï¼Œä¾¿äºç”Ÿæˆæ›´æ–°æ—¥å¿—å’Œç‰ˆæœ¬ç®¡ç†ã€‚

### **æµ‹è¯•ç­–ç•¥**
- **æµ‹è¯•é‡‘å­—å¡”**: é‡ç‚¹ç¼–å†™å•å…ƒæµ‹è¯•ï¼ˆVitestï¼‰ï¼Œè¾…ä»¥é›†æˆæµ‹è¯•å’Œç«¯åˆ°ç«¯æµ‹è¯•ï¼ˆPlaywright/Cypressï¼‰ã€‚
- **æµ‹è¯•è¦†ç›–ç‡**: è®¾å®šæ ¸å¿ƒä¸šåŠ¡é€»è¾‘çš„æœ€ä½æµ‹è¯•è¦†ç›–ç‡ç›®æ ‡ï¼ˆå¦‚ 80%ï¼‰ã€‚
- **è‡ªåŠ¨åŒ–æµ‹è¯•**: åœ¨ CI æµç¨‹ä¸­è‡ªåŠ¨è¿è¡Œæ‰€æœ‰æµ‹è¯•ï¼Œç¡®ä¿ä»£ç è´¨é‡ã€‚

### **å®‰å…¨å®è·µ**
- **ç¯å¢ƒå˜é‡**: ä¸¥æ ¼åˆ†ç¦»å¼€å‘ã€é¢„è§ˆå’Œç”Ÿäº§ç¯å¢ƒçš„ç¯å¢ƒå˜é‡ï¼Œæ•æ„Ÿä¿¡æ¯å­˜å‚¨åœ¨ Vercel å’Œ Supabase çš„å®‰å…¨è®¾ç½®ä¸­ã€‚
- **æœ€å°æƒé™åŸåˆ™**: æ•°æ®åº“ç”¨æˆ·å’Œ API å¯†é’¥åªæˆäºˆæ‰€éœ€çš„æœ€å°æƒé™ã€‚
- **ä¾èµ–å®¡è®¡**: å®šæœŸä½¿ç”¨ `pnpm audit` æ£€æŸ¥å¹¶ä¿®å¤ä¾èµ–åº“çš„å®‰å…¨æ¼æ´ã€‚
- **è¡Œçº§å®‰å…¨ (RLS)**: å……åˆ†åˆ©ç”¨ Supabase çš„ RLS åŠŸèƒ½ï¼Œç¡®ä¿ç”¨æˆ·åªèƒ½è®¿é—®è‡ªå·±çš„æ•°æ®ã€‚


---

## 9. æŠ€æœ¯é€‰å‹æ·±åº¦å¯¹æ¯”

ä¸ºäº†è®©æ‚¨æ›´æ¸…æ¥šåœ°ç†è§£æˆ‘ä»¬çš„æŠ€æœ¯é€‰å‹ï¼Œä»¥ä¸‹æ˜¯å¯¹å‡ ä¸ªå…³é”®æŠ€æœ¯çš„æ·±åº¦å¯¹æ¯”åˆ†æã€‚

### **9.1. API å±‚ï¼štRPC vs REST vs GraphQL**

| å¯¹æ¯”ç»´åº¦ | tRPC | REST | GraphQL |
|---|---|---|---|
| **ç±»å‹å®‰å…¨** | âœ… **ç«¯åˆ°ç«¯è‡ªåŠ¨** | âŒ éœ€è¦æ‰‹åŠ¨ç»´æŠ¤ | âš ï¸ éœ€è¦ Codegen |
| **å¼€å‘æ•ˆç‡** | âœ… **æé«˜ï¼ˆæ— éœ€å®šä¹‰ Schemaï¼‰** | âš ï¸ ä¸­ç­‰ | âš ï¸ ä¸­ç­‰ï¼ˆéœ€è¦å­¦ä¹  SDLï¼‰ |
| **å­¦ä¹ æ›²çº¿** | âœ… **å¹³ç¼“ï¼ˆå°±æ˜¯ TypeScript å‡½æ•°ï¼‰** | âœ… å¹³ç¼“ | âŒ é™¡å³­ |
| **æ€§èƒ½** | âœ… é«˜ï¼ˆHTTP/2, æ‰¹é‡è¯·æ±‚ï¼‰ | âœ… é«˜ | âš ï¸ å–å†³äºæŸ¥è¯¢å¤æ‚åº¦ |
| **ç”Ÿæ€æˆç†Ÿåº¦** | âš ï¸ è¾ƒæ–°ï¼ˆ2020+ï¼‰ | âœ… éå¸¸æˆç†Ÿ | âœ… æˆç†Ÿ |
| **é€‚ç”¨åœºæ™¯** | **å…¨æ ˆ TypeScript é¡¹ç›®** | é€šç”¨åœºæ™¯ | å¤æ‚æ•°æ®å…³ç³»æŸ¥è¯¢ |

**ä¸ºä»€ä¹ˆé€‰æ‹© tRPCï¼Ÿ**
å¯¹äº GraylumAI è¿™æ ·çš„å…¨æ ˆ TypeScript é¡¹ç›®ï¼ŒtRPC æ˜¯æœ€ä¼˜é€‰æ‹©ã€‚å®ƒæ— éœ€ç¼–å†™ä»»ä½• API æ–‡æ¡£æˆ– Schema å®šä¹‰ï¼Œå‰ç«¯å°±èƒ½è·å¾—å®Œæ•´çš„ç±»å‹å®‰å…¨å’Œè‡ªåŠ¨è¡¥å…¨ã€‚å½“ä½ åœ¨åç«¯ä¿®æ”¹ä¸€ä¸ª API çš„è¿”å›å€¼æ—¶ï¼Œå‰ç«¯çš„æ‰€æœ‰è°ƒç”¨å¤„ä¼šç«‹åˆ»å‡ºç°ç±»å‹é”™è¯¯ï¼Œè¿™ç§ç¼–è¯‘æ—¶çš„ä¿éšœè¿œæ¯”è¿è¡Œæ—¶çš„æµ‹è¯•æ›´å¯é ã€‚

### **9.2. ORMï¼šDrizzle vs Prisma**

| å¯¹æ¯”ç»´åº¦ | Drizzle ORM | Prisma |
|---|---|---|---|
| **æ€§èƒ½** | âœ… **æ¥è¿‘åŸç”Ÿ SQL** | âš ï¸ æœ‰ä¸€å®šå¼€é”€ |
| **ç±»å‹æ¨æ–­** | âœ… **å¼ºå¤§ä¸”ç²¾å‡†** | âœ… å¼ºå¤§ |
| **è¿ç§»ç®¡ç†** | âœ… SQL-first | âš ï¸ æŠ½è±¡å±‚è¾ƒé«˜ |
| **å­¦ä¹ æ›²çº¿** | âš ï¸ éœ€è¦ SQL åŸºç¡€ | âœ… å¯¹æ–°æ‰‹å‹å¥½ |
| **åŒ…å¤§å°** | âœ… **è½»é‡ï¼ˆ~100KBï¼‰** | âŒ è¾ƒå¤§ï¼ˆ~5MBï¼‰ |
| **Edge Runtime** | âœ… **å®Œç¾æ”¯æŒ** | âš ï¸ éƒ¨åˆ†æ”¯æŒ |

**ä¸ºä»€ä¹ˆé€‰æ‹© Drizzleï¼Ÿ**
Drizzle æ˜¯æ–°ä¸€ä»£çš„ TypeScript ORMï¼Œå®ƒä¸åƒ Prisma é‚£æ ·è¯•å›¾éšè— SQLï¼Œè€Œæ˜¯æ‹¥æŠ± SQLã€‚è¿™ä½¿å¾—å®ƒçš„æ€§èƒ½æ›´å¥½ã€ç±»å‹æ¨æ–­æ›´ç²¾å‡†ï¼Œä¸”å®Œç¾æ”¯æŒ Vercel Edge Runtimeã€‚å¯¹äºç†Ÿæ‚‰ SQL çš„å¼€å‘è€…ï¼ŒDrizzle æä¾›äº†æ›´é«˜çš„çµæ´»æ€§å’Œæ§åˆ¶åŠ›ã€‚

### **9.3. çŠ¶æ€ç®¡ç†ï¼šZustand vs Redux Toolkit**

| å¯¹æ¯”ç»´åº¦ | Zustand | Redux Toolkit |
|---|---|---|---|
| **ä»£ç é‡** | âœ… **æå°‘** | âš ï¸ è¾ƒå¤š |
| **å­¦ä¹ æ›²çº¿** | âœ… **å¹³ç¼“** | âš ï¸ é™¡å³­ |
| **æ€§èƒ½** | âœ… ä¼˜ç§€ | âœ… ä¼˜ç§€ |
| **DevTools** | âš ï¸ åŸºç¡€ | âœ… å¼ºå¤§ |
| **ç”Ÿæ€** | âš ï¸ è¾ƒå° | âœ… åºå¤§ |
| **é€‚ç”¨åœºæ™¯** | **ä¸­å°å‹åº”ç”¨** | å¤§å‹å¤æ‚åº”ç”¨ |

**ä¸ºä»€ä¹ˆé€‰æ‹© Zustandï¼Ÿ**
å¯¹äº GraylumAI çš„è§„æ¨¡ï¼ŒRedux çš„å¤æ‚æ€§æ˜¯ä¸å¿…è¦çš„ã€‚Zustand æä¾›äº†ç®€æ´çš„ API å’Œä¼˜ç§€çš„æ€§èƒ½ï¼Œä¸”ä¸ React Hooks å®Œç¾ç»“åˆã€‚æ›´é‡è¦çš„æ˜¯ï¼Œç”±äºæˆ‘ä»¬ä½¿ç”¨ TanStack Query ç®¡ç†æœåŠ¡ç«¯çŠ¶æ€ï¼Œå®¢æˆ·ç«¯çŠ¶æ€çš„ç®¡ç†éœ€æ±‚å¤§å¤§å‡å°‘ï¼ŒZustand å·²ç»è¶³å¤Ÿã€‚

---

## 10. ä»£ç ç¤ºä¾‹ï¼šæ–°æ¶æ„ vs æ—§æ¶æ„

ä¸ºäº†è®©æ‚¨ç›´è§‚æ„Ÿå—æ–°æ¶æ„çš„ä¼˜åŠ¿ï¼Œä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„å¯¹æ¯”ç¤ºä¾‹ã€‚

### **åœºæ™¯ï¼šè·å–ç”¨æˆ·çš„å¯¹è¯åˆ—è¡¨**

#### **æ—§æ¶æ„ (Base44 + JavaScript)**

```javascript
// src/pages/ChatHistory.jsx
import { useEffect, useState } from 'react';
import base44 from '../api/base44Client';

function ChatHistory() {
  const [conversations, setConversations] = useState([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);

  useEffect(() => {
    async function fetchConversations() {
      try {
        setLoading(true);
        // æ²¡æœ‰ç±»å‹æç¤ºï¼Œå®¹æ˜“æ‹¼å†™é”™è¯¯
        const data = await base44.entities.conversations.find({
          where: { user_id: base44.auth.currentUser.id },
          orderBy: { created_at: 'desc' }
        });
        setConversations(data);
      } catch (err) {
        // é”™è¯¯æ ¼å¼ä¸ç»Ÿä¸€
        setError(err.message);
      } finally {
        setLoading(false);
      }
    }
    fetchConversations();
  }, []);

  if (loading) return <div>Loading...</div>;
  if (error) return <div>Error: {error}</div>;

  return (
    <div>
      {conversations.map(conv => (
        // æ²¡æœ‰ç±»å‹æ£€æŸ¥ï¼Œconv.title å¯èƒ½ä¸å­˜åœ¨
        <div key={conv.id}>{conv.title}</div>
      ))}
    </div>
  );
}
```

**é—®é¢˜**:
- æ— ç±»å‹å®‰å…¨ï¼Œ`conv.title` å¯èƒ½æ‹¼å†™é”™è¯¯æˆ–å­—æ®µä¸å­˜åœ¨ï¼Œåªèƒ½åœ¨è¿è¡Œæ—¶å‘ç°ã€‚
- æ‰‹åŠ¨ç®¡ç† `loading` å’Œ `error` çŠ¶æ€ï¼Œä»£ç å†—ä½™ã€‚
- æ²¡æœ‰ç¼“å­˜ï¼Œæ¯æ¬¡ç»„ä»¶é‡æ–°æ¸²æŸ“éƒ½ä¼šé‡æ–°è¯·æ±‚ã€‚

#### **æ–°æ¶æ„ (tRPC + TypeScript + TanStack Query)**

```typescript
// apps/web/src/app/chat-history/page.tsx
'use client';
import { trpc } from '@/trpc/client';

function ChatHistory() {
  // è‡ªåŠ¨ç±»å‹æ¨æ–­ï¼Œè‡ªåŠ¨ç®¡ç† loading/error/ç¼“å­˜
  const { data: conversations, isLoading, error } = trpc.chat.getConversations.useQuery();

  if (isLoading) return <div>Loading...</div>;
  if (error) return <div>Error: {error.message}</div>;

  return (
    <div>
      {conversations?.map(conv => (
        // TypeScript ä¼šæ£€æŸ¥ conv.title æ˜¯å¦å­˜åœ¨
        <div key={conv.id}>{conv.title}</div>
      ))}
    </div>
  );
}
```

```typescript
// packages/api/src/routers/chat.ts
import { z } from 'zod';
import { router, protectedProcedure } from '../trpc';
import { db } from '@repo/db';
import { conversations } from '@repo/db/schema';
import { eq, desc } from 'drizzle-orm';

export const chatRouter = router({
  getConversations: protectedProcedure
    .query(async ({ ctx }) => {
      // ctx.user ç”±ä¸­é—´ä»¶è‡ªåŠ¨æ³¨å…¥ï¼Œç±»å‹å®‰å…¨
      return await db
        .select()
        .from(conversations)
        .where(eq(conversations.userId, ctx.user.id))
        .orderBy(desc(conversations.createdAt));
    }),
});
```

**ä¼˜åŠ¿**:
- âœ… **å®Œå…¨çš„ç±»å‹å®‰å…¨**: `conversations` çš„ç±»å‹è‡ªåŠ¨ä»åç«¯æ¨æ–­ï¼Œå‰ç«¯æ— éœ€æ‰‹åŠ¨å®šä¹‰ã€‚
- âœ… **è‡ªåŠ¨çŠ¶æ€ç®¡ç†**: TanStack Query è‡ªåŠ¨å¤„ç† `loading`, `error`, `caching`, `refetching`ã€‚
- âœ… **ä»£ç æ›´ç®€æ´**: å‰ç«¯ä»£ç å‡å°‘äº† 50% ä»¥ä¸Šã€‚
- âœ… **æ›´æ˜“ç»´æŠ¤**: ä¿®æ”¹åç«¯è¿”å›å€¼ï¼Œå‰ç«¯ç«‹åˆ»å¾—åˆ°ç±»å‹é”™è¯¯æç¤ºã€‚

---

## 11. æˆæœ¬ä¸æ”¶ç›Šåˆ†æ

| é¡¹ç›® | æ—§æ¶æ„ (Base44) | æ–°æ¶æ„ (Vercel + Supabase) | è¯´æ˜ |
|---|---|---|---|
| **æœˆåº¦æˆæœ¬** | çº¦ $50-100 | çº¦ $20-50 | Vercel å’Œ Supabase çš„å…è´¹é¢åº¦æ›´é«˜ï¼ŒæŒ‰éœ€ä»˜è´¹æ›´çµæ´» |
| **é‡æ„å·¥æ—¶** | - | çº¦ 20-30 äººå¤© | ä¸€æ¬¡æ€§æŠ•å…¥ |
| **é•¿æœŸç»´æŠ¤æˆæœ¬** | é«˜ | **ä½** | ç±»å‹å®‰å…¨å’Œè‡ªåŠ¨åŒ–æµ‹è¯•å¤§å¹…å‡å°‘ Bug |
| **å¼€å‘æ•ˆç‡æå‡** | - | **+50%** | ç±»å‹æ¨æ–­ã€è‡ªåŠ¨è¡¥å…¨ã€å‡å°‘è°ƒè¯•æ—¶é—´ |
| **æŠ€æœ¯å€ºåŠ¡** | æŒç»­ç´¯ç§¯ | **æ˜¾è‘—é™ä½** | æ¸…æ™°çš„æ¶æ„å’Œè§„èŒƒå‡å°‘æŠ€æœ¯å€ºåŠ¡ |
| **å¯æ‰©å±•æ€§** | å—é™ | **ä¼˜ç§€** | Monorepo å’Œæ¨¡å—åŒ–è®¾è®¡æ˜“äºæ‰©å±• |

---

## 12. æ€»ç»“ä¸å»ºè®®

é€šè¿‡æœ¬æ¬¡æ¶æ„é‡æ„ï¼ŒGraylumAI å°†ä»ä¸€ä¸ªä¾èµ–å¹³å°é»‘ç›’çš„åº”ç”¨ï¼Œè½¬å˜ä¸ºä¸€ä¸ª**æŠ€æœ¯æ ˆç°ä»£åŒ–ã€æ¶æ„æ¸…æ™°ã€æ˜“äºç»´æŠ¤å’Œæ‰©å±•**çš„å…¨æ ˆ TypeScript åº”ç”¨ã€‚

### **æ ¸å¿ƒæ”¶ç›Š**
1. **ç«¯åˆ°ç«¯çš„ç±»å‹å®‰å…¨**: ä»æ•°æ®åº“åˆ°å‰ç«¯ï¼Œæ‰€æœ‰ä»£ç éƒ½æœ‰ TypeScript ä¿æŠ¤ï¼Œè¿è¡Œæ—¶é”™è¯¯å¤§å¹…å‡å°‘ã€‚
2. **å“è¶Šçš„å¼€å‘ä½“éªŒ**: è‡ªåŠ¨è¡¥å…¨ã€ç±»å‹æ¨æ–­ã€çƒ­é‡è½½ç­‰ç°ä»£åŒ–å·¥å…·é“¾ï¼Œè®©å¼€å‘æ•ˆç‡æå‡ 50% ä»¥ä¸Šã€‚
3. **æ›´ä½çš„ç»´æŠ¤æˆæœ¬**: æ¸…æ™°çš„æ¶æ„ã€è‡ªåŠ¨åŒ–æµ‹è¯•å’Œè§„èŒƒåŒ–çš„æµç¨‹ï¼Œè®©æœªæ¥çš„è¿­ä»£æ›´å¿«ã€æ›´å®‰å…¨ã€‚
4. **æ— å‚å•†é”å®š**: å®Œå…¨åŸºäºå¼€æºæŠ€æœ¯ï¼Œå¯ä»¥è‡ªç”±è¿ç§»åˆ°ä»»ä½•æ”¯æŒ Node.js çš„å¹³å°ã€‚

### **æˆ‘çš„å»ºè®®**
å¦‚æœæ‚¨å¸Œæœ› GraylumAI ä¸ä»…ä»…æ˜¯"èƒ½ç”¨"ï¼Œè€Œæ˜¯æˆä¸ºä¸€ä¸ª**é«˜è´¨é‡ã€å¯æŒç»­å‘å±•**çš„äº§å“ï¼Œæˆ‘å¼ºçƒˆå»ºè®®é‡‡ç”¨æœ¬æ–¹æ¡ˆè¿›è¡Œé‡æ„ã€‚è™½ç„¶éœ€è¦ä¸€å®šçš„åˆæœŸæŠ•å…¥ï¼ˆçº¦ 20-30 äººå¤©ï¼‰ï¼Œä½†é•¿æœŸæ¥çœ‹ï¼Œè¿™å°†ä¸ºæ‚¨èŠ‚çœå¤§é‡çš„ç»´æŠ¤æˆæœ¬å’Œæ—¶é—´ï¼Œå¹¶ä¸ºæœªæ¥çš„åŠŸèƒ½æ‰©å±•æ‰“ä¸‹åšå®çš„åŸºç¡€ã€‚

ä½œä¸º Manus AIï¼Œæˆ‘å¯ä»¥å…¨ç¨‹ååŠ©æ‚¨å®Œæˆè¿™æ¬¡é‡æ„ï¼Œä»ä»£ç ç¼–å†™ã€æµ‹è¯•åˆ°éƒ¨ç½²ï¼Œç¡®ä¿æ•´ä¸ªè¿‡ç¨‹é¡ºåˆ©ã€é«˜æ•ˆã€‚
